{"data":{"site":{"siteMetadata":{"fullName":"olivia ifrim","settings":{"disqusShortName":"oliviaifrim","disqusEnabled":false},"twitterHandle":"@oliviff"}},"markdownRemark":{"id":"dc445516-1cc5-56b4-9208-1d56a8b783c5","html":"<p>In this post I'll talk about a small game I've been developing in about 24 hours in total (mostly in a few hour blocks during evenings or weekends). The game is far from finished, but I thought I'd write up about my experience so far, what I've learnt and some interesting observations about building a game from scratch-ish and doing it in Rust. </p>\n<h2>Why Rust?</h2>\n<p>I picked Rust because I've been hearing great things about it and I see it's been having some traction in the game development space. I have to say at the point which I started this game I had written a few small programs in Rust, just enough to not feel like my hands were tied when I started writing the game. </p>\n<h2>Why a game and what game?</h2>\n<p>Making games is fun! I wish there was a more elaborate reason than that, but for side projects I normally prefer things that are quite far from what I do daily at my job. Now, what game? I wanted to make a simulation game with a tennis theme, think like Cities Skylines meets Zoo Tycoon with tennis and pixel art. I haven't got it all figured out yet, but it's basically a tennis academy where people come and play tennis.</p>\n<h2>The making of the game!</h2>\n<h3>Research</h3>\n<p>I knew I wanted to use Rust, but I didn't know exactly how much \"from-scratch\" I wanted to make it. I didn't want to write pixel shaders, but I didn't want to use drag and drop either, so I had to pick something that gave me enough flexibility but also keep it interesting from an engineering perspective without going too low level. </p>\n<p>I found a few useful resources which I'll link here in case you want to have a look: </p>\n<ul>\n<li><a href=\"http://arewegameyet.com/\">Are we game yet</a> - a list of game dev related Rust packages</li>\n<li><a href=\"https://www.reddit.com/r/rust_gamedev\">Rust game dev subreddit</a></li>\n<li><a href=\"https://kenney.nl\">Free pixel art</a></li>\n</ul>\n<p>I did a little research on Rust game engines and was left with two main contenders: Piston and ggez. I tried both in a previous small project and I ended up going with ggez because it seemed easier to use for a small 2D game. Piston's modularity seemed a bit unapproachable from a beginner's point a few.</p>\n<h3>The game</h3>\n<p>I then spent a bit of time thinking about the game. </p>\n<p>In terms of entities we would probably have:</p>\n<ul>\n<li>Floor </li>\n<li>Person (the tennis players basically, but maybe in the future also coaches)</li>\n<li>Tennis court </li>\n</ul>\n<p>In terms of mechanics we'd need to:</p>\n<ul>\n<li>be able to build entities (some sort of build mode)</li>\n<li>be able to render said entities</li>\n<li>be able to assign people to courts and have them play</li>\n</ul>\n<p>And eventually:</p>\n<ul>\n<li>money</li>\n<li>skills</li>\n<li>different types of courts </li>\n<li>... </li>\n</ul>\n<p>At this point I felt like I had enough ideas to start coding. (being PM and dev is quite fun! I'd still rather have a PM though ..)</p>\n<h3>The beginnings: circles and abstraction</h3>\n<p>I pretty much ripped off a ggez sample and got a window with a circle in it up on the screen. Amazing! Next, some abstraction. I thought it would be a good idea to abstract the idea of a game object. Every game object can be rendered and updated, something like this (if you're rolling your eyes at this point, this was before I found out about ECS, so bear with me here). </p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token comment\">// the game object trait</span>\n<span class=\"token keyword\">trait</span> GameObject <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> _ctx<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// a specific game object - Circle</span>\n<span class=\"token keyword\">struct</span> Circle <span class=\"token punctuation\">{</span>\n    position<span class=\"token punctuation\">:</span> Point2<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n <span class=\"token keyword\">impl</span> Circle <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">new</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">:</span> Point2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> Circle <span class=\"token punctuation\">{</span>\n        Circle <span class=\"token punctuation\">{</span> position <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">impl</span> GameObject <span class=\"token keyword\">for</span> Circle <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> _ctx<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">Ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> ctx<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> circle <span class=\"token operator\">=</span>\n            graphics<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Mesh<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">new_circle</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> graphics<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>DrawMode<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Fill<span class=\"token punctuation\">,</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">,</span> <span class=\"token number\">100.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2.0</span><span class=\"token punctuation\">)</span>?<span class=\"token punctuation\">;</span>\n\n         graphics<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>circle<span class=\"token punctuation\">,</span> na<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Point2<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span>?<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">Ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This allowed me to have a nice list of objects which I could update and render in a nice loop. </p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">impl</span> event<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>EventHandler <span class=\"token keyword\">for</span> MainState <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Update all objects</span>\n        <span class=\"token keyword\">for</span> object <span class=\"token keyword\">in</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token function\">iter_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            object<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span>?<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token function\">Ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">fn</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">:</span> <span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> GameResult<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n        graphics<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Draw all objects</span>\n        <span class=\"token keyword\">for</span> object <span class=\"token keyword\">in</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token function\">iter_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            object<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span>?<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        graphics<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">present</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">Ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>At this point <code class=\"language-text\">main.rs</code> was the place to be, because every single line of code was there, so I spent some time breaking that up into separate files and rationalizing the directory structure a bit. </p>\n<h3>People, floors and images</h3>\n<p>The next big milestone was creating a <code class=\"language-text\">Person</code> game object and loading images. I decided everything will be tile based (currently 32x32 tiles).</p>\n<p><img src=\"/1-6424c665cb9442c5471a49d987954880.png\" alt=\"alt text\" title=\"People, floors and images\"></p>\n<h3>Tennis courts</h3>\n<p>I spent some time looking at images of tennis courts online and I figured I'd want my tennis court to be 4*2 tiles. I would make an image that wide, or I could have 8 separate tiles. On further inspection I actually realized I only need 2 unique tiles to build the whole court. Let me explain. </p>\n<p>2 unique tiles: 1 and 2. </p>\n<p>Each section of the court is actually made up of either tile 1 or tile 2, either as is or rotated 180 degrees. </p>\n<p><img src=\"/tennis_court-26dde1e6f7ec2459c89752754a048c04.png\" alt=\"alt text\" title=\"Constructing a tennis court\"></p>","excerpt":"In this post I'll talk about a small game I've been developing in about 24 hours in total (mostly in a few hour blocks during evenings or…","frontmatter":{"title":"24 hours of game development in Rust","date":"March 01, 2019","tags":["game dev","rust"],"featuredImage":{"childImageSharp":{"sizes":{"src":"/static/4a6d17dbef066cb8aa461bc1f74a24b9/5aa81/design.jpg","srcSet":"/static/4a6d17dbef066cb8aa461bc1f74a24b9/25db0/design.jpg 175w,\n/static/4a6d17dbef066cb8aa461bc1f74a24b9/62b24/design.jpg 350w,\n/static/4a6d17dbef066cb8aa461bc1f74a24b9/5aa81/design.jpg 700w,\n/static/4a6d17dbef066cb8aa461bc1f74a24b9/11eb7/design.jpg 822w","base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAdOd5AiOjr//xAAbEAACAgMBAAAAAAAAAAAAAAAAAQIRAwQSE//aAAgBAQABBQKOez1HspFIpHET/8QAGREAAgMBAAAAAAAAAAAAAAAAAAIRITFR/9oACAEDAQE/AVrSV4f/xAAYEQADAQEAAAAAAAAAAAAAAAAAASECEf/aAAgBAgEBPwHSfYU//8QAGBABAQADAAAAAAAAAAAAAAAAADEBEDL/2gAIAQEABj8C5RE1MP/EABsQAAICAwEAAAAAAAAAAAAAAAABETFBYZGh/9oACAEBAAE/IcH0VkNIb9EqkNSGy+R//9oADAMBAAIAAwAAABCcD//EABYRAAMAAAAAAAAAAAAAAAAAABARUf/aAAgBAwEBPxBqjf/EABgRAQEAAwAAAAAAAAAAAAAAAAEAESFR/9oACAECAQE/EE7MEHV//8QAGxAAAwACAwAAAAAAAAAAAAAAAAERIVFhcbH/2gAIAQEAAT8QYrbFN0RdeMjDWWhagukYF5DGsPof/9k=","aspectRatio":2.3333333333333335,"sizes":"(max-width: 700px) 100vw, 700px"}}}}}},"pageContext":{"slug":"/posts/24-hours-of-rust-game-dev/","previous":{"fields":{"slug":"/posts/design-patterns/"},"frontmatter":{"title":"Design patterns"}},"next":null}}